{
  "name": "microsoftTeamsTrigger",
  "displayName": "Microsoft Teams Trigger",
  "description": "Triggers workflows in n8n based on events from Microsoft Teams, such as new messages or team updates, using specified configurations.",
  "group": [
    "trigger"
  ],
  "version": 1,
  "defaults": {
    "event": "newChannelMessage",
    "watchAllTeams": false,
    "teamId": {
      "__rl": true,
      "mode": "list",
      "value": ""
    },
    "watchAllChannels": false,
    "channelId": {
      "__rl": true,
      "mode": "list",
      "value": ""
    },
    "watchAllChats": false,
    "chatId": {
      "__rl": true,
      "mode": "list",
      "value": ""
    }
  },
  "inputs": [],
  "outputs": [
    "main"
  ],
  "properties": [
    {
      "name": "event",
      "displayName": "Trigger On",
      "type": "options",
      "default": "newChannelMessage",
      "description": "Select the event to trigger the workflow",
      "options": [
        {
          "name": "New Channel",
          "value": "newChannel",
          "description": "A new channel is created"
        },
        {
          "name": "New Channel Message",
          "value": "newChannelMessage",
          "description": "A message is posted to a channel"
        },
        {
          "name": "New Chat",
          "value": "newChat",
          "description": "A new chat is created"
        },
        {
          "name": "New Chat Message",
          "value": "newChatMessage",
          "description": "A message is posted to a chat"
        },
        {
          "name": "New Team Member",
          "value": "newTeamMember",
          "description": "A new member is added to a team"
        }
      ]
    },
    {
      "name": "watchAllTeams",
      "displayName": "Watch All Teams",
      "type": "boolean",
      "default": false,
      "description": "Whether to watch for the event in all the available teams",
      "displayOptions": {
        "show": {
          "event": [
            "newChannel",
            "newChannelMessage",
            "newTeamMember"
          ]
        }
      }
    },
    {
      "name": "teamId",
      "displayName": "Team",
      "type": "resourceLocator",
      "default": {
        "mode": "list",
        "value": ""
      },
      "required": true,
      "description": "Select a team from the list, enter an ID or a URL",
      "displayOptions": {
        "show": {
          "event": [
            "newChannel",
            "newChannelMessage",
            "newTeamMember"
          ],
          "watchAllTeams": [
            false
          ]
        }
      }
    },
    {
      "name": "watchAllChannels",
      "displayName": "Watch All Channels",
      "type": "boolean",
      "default": false,
      "description": "Whether to watch for the event in all the available channels",
      "displayOptions": {
        "show": {
          "event": [
            "newChannelMessage"
          ],
          "watchAllTeams": [
            false
          ]
        }
      }
    },
    {
      "name": "channelId",
      "displayName": "Channel",
      "type": "resourceLocator",
      "default": {
        "mode": "list",
        "value": ""
      },
      "required": true,
      "description": "Select a channel from the list, enter an ID or a URL",
      "displayOptions": {
        "show": {
          "event": [
            "newChannelMessage"
          ],
          "watchAllTeams": [
            false
          ],
          "watchAllChannels": [
            false
          ]
        }
      }
    },
    {
      "name": "watchAllChats",
      "displayName": "Watch All Chats",
      "type": "boolean",
      "default": false,
      "description": "Whether to watch for the event in all the available chats",
      "displayOptions": {
        "show": {
          "event": [
            "newChatMessage"
          ]
        }
      }
    },
    {
      "name": "chatId",
      "displayName": "Chat",
      "type": "resourceLocator",
      "default": {
        "mode": "list",
        "value": ""
      },
      "required": true,
      "description": "Select a chat from the list, enter an ID or a URL",
      "displayOptions": {
        "show": {
          "event": [
            "newChatMessage"
          ],
          "watchAllChats": [
            false
          ]
        }
      }
    }
  ],
  "credentials": [
    {
      "name": "microsoftTeamsOAuth2Api",
      "required": true
    }
  ],
  "requiredFields": [
    "teamId",
    "channelId",
    "chatId"
  ],
  "optionalFields": [
    "event",
    "watchAllTeams",
    "watchAllChannels",
    "watchAllChats"
  ],
  "parameterTypes": {
    "event": "options",
    "watchAllTeams": "boolean",
    "teamId": "resourceLocator",
    "watchAllChannels": "boolean",
    "channelId": "resourceLocator",
    "watchAllChats": "boolean",
    "chatId": "resourceLocator"
  },
  "hasVersions": false
}