{
  "name": "cortex",
  "displayName": "Cortex",
  "description": "Apply the Cortex analyzer/responder on the given entity",
  "group": [
    "transform"
  ],
  "version": 1,
  "defaults": {
    "resource": "analyzer",
    "operation": "execute",
    "analyzer": "",
    "observableType": "",
    "observableValue": "",
    "binaryPropertyName": "data",
    "tlp": 2,
    "additionalFields": {},
    "responder": "",
    "entityType": "",
    "jsonObject": false,
    "objectData": "",
    "parameters": {},
    "jobId": ""
  },
  "inputs": [
    "main"
  ],
  "outputs": [
    "main"
  ],
  "properties": [
    {
      "name": "resource",
      "displayName": "Resource",
      "type": "options",
      "default": "analyzer",
      "required": true,
      "description": "Choose a resource",
      "options": [
        {
          "name": "Analyzer",
          "value": "analyzer"
        },
        {
          "name": "Job",
          "value": "job"
        },
        {
          "name": "Responder",
          "value": "responder"
        }
      ]
    },
    {
      "name": "operation",
      "displayName": "Operation",
      "type": "options",
      "default": "execute",
      "required": true,
      "description": "Choose an operation",
      "options": [
        {
          "name": "Execute",
          "value": "execute",
          "description": "Execute Analyzer",
          "action": "Execute an analyzer"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ]
        }
      }
    },
    {
      "name": "analyzer",
      "displayName": "Analyzer Type Name or ID",
      "type": "options",
      "default": "",
      "required": true,
      "description": "Choose the analyzer. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "typeOptions": {
        "loadOptionsMethod": "loadActiveAnalyzers"
      },
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "observableType",
      "displayName": "Observable Type Name or ID",
      "type": "options",
      "default": "",
      "required": true,
      "description": "Choose the observable type. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "typeOptions": {
        "loadOptionsMethod": "loadObservableOptions",
        "loadOptionsDependsOn": [
          "analyzer"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        },
        "hide": {
          "analyzer": [
            ""
          ]
        }
      }
    },
    {
      "name": "observableValue",
      "displayName": "Observable Value",
      "type": "string",
      "default": "",
      "required": true,
      "description": "Enter the observable value",
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        },
        "hide": {
          "observableType": [
            "file"
          ],
          "analyzer": [
            ""
          ]
        }
      }
    },
    {
      "name": "binaryPropertyName",
      "displayName": "Put Output File in Field",
      "type": "string",
      "default": "data",
      "required": true,
      "displayOptions": {
        "show": {
          "observableType": [
            "file"
          ],
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "tlp",
      "displayName": "TLP",
      "type": "options",
      "default": 2,
      "description": "The TLP of the analyzed observable",
      "options": [
        {
          "name": "White",
          "value": 0
        },
        {
          "name": "Green",
          "value": 1
        },
        {
          "name": "Amber",
          "value": 2
        },
        {
          "name": "Red",
          "value": 3
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        },
        "hide": {
          "observableType": [
            ""
          ],
          "analyzer": [
            ""
          ]
        }
      }
    },
    {
      "name": "additionalFields",
      "displayName": "Additional Fields",
      "type": "collection",
      "default": {},
      "options": [
        {
          "displayName": "Force",
          "name": "force",
          "type": "boolean",
          "default": false,
          "description": "Whether to force bypassing the cache"
        },
        {
          "displayName": "Timeout (Seconds)",
          "name": "timeout",
          "type": "number",
          "default": 3,
          "description": "Timeout to wait for the report in case it is not available at the time the query was made"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "operation",
      "displayName": "Operation",
      "type": "options",
      "default": "execute",
      "required": true,
      "description": "Choose an operation",
      "options": [
        {
          "name": "Execute",
          "value": "execute",
          "description": "Execute Responder",
          "action": "Execute a responder"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "responder",
      "displayName": "Responder Type Name or ID",
      "type": "options",
      "default": "",
      "required": true,
      "description": "Choose the responder. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "typeOptions": {
        "loadOptionsMethod": "loadActiveResponders"
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "entityType",
      "displayName": "Entity Type Name or ID",
      "type": "options",
      "default": "",
      "required": true,
      "description": "Choose the Data type. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "typeOptions": {
        "loadOptionsMethod": "loadDataTypeOptions",
        "loadOptionsDependsOn": [
          "responder"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "jsonObject",
      "displayName": "JSON Parameters",
      "type": "boolean",
      "default": false,
      "description": "Choose between providing JSON object or seperated attributes",
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "objectData",
      "displayName": "Entity Object (JSON)",
      "type": "string",
      "default": "",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            true
          ]
        }
      }
    },
    {
      "name": "parameters",
      "displayName": "Parameters",
      "type": "fixedCollection",
      "default": {},
      "options": [
        {
          "displayName": "Case Attributes",
          "name": "values",
          "values": [
            {
              "displayName": "Description",
              "name": "description",
              "type": "string",
              "default": "",
              "description": "Description of the case"
            },
            {
              "displayName": "Flag",
              "name": "flag",
              "type": "boolean",
              "default": false,
              "description": "Flag of the case default=false"
            },
            {
              "displayName": "Owner",
              "name": "owner",
              "type": "string",
              "default": "",
              "description": "User who owns the case. This is automatically set to current user when status is set to InProgress."
            },
            {
              "displayName": "Severity",
              "name": "severity",
              "type": "options",
              "default": 2,
              "options": [
                {
                  "name": "Low",
                  "value": 1
                },
                {
                  "name": "Medium",
                  "value": 2
                },
                {
                  "name": "High",
                  "value": 3
                }
              ],
              "description": "Severity of the case. Default=Medium."
            },
            {
              "displayName": "Start Date",
              "name": "startDate",
              "type": "dateTime",
              "default": "",
              "description": "Date and time of the begin of the case default=now"
            },
            {
              "displayName": "Tags",
              "name": "tags",
              "type": "string",
              "default": "",
              "placeholder": "tag1,tag2,..."
            },
            {
              "displayName": "Title",
              "name": "title",
              "type": "string",
              "default": "",
              "description": "Title of the case"
            },
            {
              "displayName": "TLP",
              "name": "tlp",
              "type": "options",
              "default": 2,
              "options": [
                {
                  "name": "White",
                  "value": 0
                },
                {
                  "name": "Green",
                  "value": 1
                },
                {
                  "name": "Amber",
                  "value": 2
                },
                {
                  "name": "Red",
                  "value": 3
                }
              ],
              "description": "Traffic Light Protocol (TLP). Default=Amber."
            }
          ]
        }
      ],
      "typeOptions": {
        "loadOptionsDependsOn": [
          "entityType"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            false
          ],
          "entityType": [
            "case"
          ]
        },
        "hide": {
          "entityType": [
            "",
            "alert",
            "case_artifact",
            "case_task",
            "case_task_log"
          ]
        }
      }
    },
    {
      "name": "parameters",
      "displayName": "Parameters",
      "type": "fixedCollection",
      "default": {},
      "options": [
        {
          "displayName": "Alert Attributes",
          "name": "values",
          "values": [
            {
              "displayName": "Artifacts",
              "name": "artifacts",
              "type": "fixedCollection",
              "placeholder": "Add an artifact",
              "typeOptions": {
                "multipleValues": true,
                "multipleValueButtonText": "Add an Artifact"
              },
              "default": [],
              "options": [
                {
                  "displayName": "Artifact",
                  "name": "artifactValues",
                  "values": [
                    {
                      "displayName": "Binary Field",
                      "name": "binaryProperty",
                      "type": "string",
                      "displayOptions": {
                        "show": {
                          "dataType": [
                            "file"
                          ]
                        }
                      },
                      "default": "data"
                    },
                    {
                      "displayName": "Data",
                      "name": "data",
                      "type": "string",
                      "displayOptions": {
                        "hide": {
                          "dataType": [
                            "file"
                          ]
                        }
                      },
                      "default": ""
                    },
                    {
                      "displayName": "Data Type",
                      "name": "dataType",
                      "type": "options",
                      "default": "",
                      "options": [
                        {
                          "name": "Domain",
                          "value": "domain"
                        },
                        {
                          "name": "File",
                          "value": "file"
                        },
                        {
                          "name": "Filename",
                          "value": "filename"
                        },
                        {
                          "name": "Fqdn",
                          "value": "fqdn"
                        },
                        {
                          "name": "Hash",
                          "value": "hash"
                        },
                        {
                          "name": "IP",
                          "value": "ip"
                        },
                        {
                          "name": "Mail",
                          "value": "mail"
                        },
                        {
                          "name": "Mail Subject",
                          "value": "mail_subject"
                        },
                        {
                          "name": "Other",
                          "value": "other"
                        },
                        {
                          "name": "Regexp",
                          "value": "regexp"
                        },
                        {
                          "name": "Registry",
                          "value": "registry"
                        },
                        {
                          "name": "Uri Path",
                          "value": "uri_path"
                        },
                        {
                          "name": "URL",
                          "value": "url"
                        },
                        {
                          "name": "User Agent",
                          "value": "user-agent"
                        }
                      ]
                    },
                    {
                      "displayName": "Message",
                      "name": "message",
                      "type": "string",
                      "default": ""
                    },
                    {
                      "displayName": "Tags",
                      "name": "tags",
                      "type": "string",
                      "default": ""
                    }
                  ]
                }
              ]
            },
            {
              "displayName": "Date",
              "name": "date",
              "type": "dateTime",
              "default": "",
              "description": "Date and time when the alert was raised default=now"
            },
            {
              "displayName": "Description",
              "name": "description",
              "type": "string",
              "default": "",
              "description": "Description of the alert"
            },
            {
              "displayName": "Follow",
              "name": "follow",
              "type": "boolean",
              "default": false
            },
            {
              "displayName": "Severity",
              "name": "severity",
              "type": "options",
              "default": 2,
              "options": [
                {
                  "name": "Low",
                  "value": 1
                },
                {
                  "name": "Medium",
                  "value": 2
                },
                {
                  "name": "High",
                  "value": 3
                }
              ],
              "description": "Severity of the case. Default=Medium."
            },
            {
              "displayName": "Source",
              "name": "source",
              "type": "string",
              "default": "",
              "description": "Source of the alert"
            },
            {
              "displayName": "SourceRef",
              "name": "sourceRef",
              "type": "string",
              "default": "",
              "description": "Source reference of the alert"
            },
            {
              "displayName": "Status",
              "name": "status",
              "type": "options",
              "default": "New",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Updated",
                  "value": "Updated"
                },
                {
                  "name": "Ignored",
                  "value": "Ignored"
                },
                {
                  "name": "Imported",
                  "value": "Imported"
                }
              ],
              "description": "Status of the alert. Default=New."
            },
            {
              "displayName": "Tags",
              "name": "tags",
              "type": "string",
              "placeholder": "tag1,tag2,...",
              "default": ""
            },
            {
              "displayName": "Title",
              "name": "title",
              "type": "string",
              "default": "",
              "description": "Title of the alert"
            },
            {
              "displayName": "TLP",
              "name": "tlp",
              "type": "options",
              "default": 2,
              "options": [
                {
                  "name": "White",
                  "value": 0
                },
                {
                  "name": "Green",
                  "value": 1
                },
                {
                  "name": "Amber",
                  "value": 2
                },
                {
                  "name": "Red",
                  "value": 3
                }
              ],
              "description": "Traffic Light Protocol (TLP). Default=Amber."
            },
            {
              "displayName": "Type",
              "name": "type",
              "type": "string",
              "default": "",
              "description": "Type of the alert"
            }
          ]
        }
      ],
      "typeOptions": {
        "loadOptionsDependsOn": [
          "entityType"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            false
          ],
          "entityType": [
            "alert"
          ]
        },
        "hide": {
          "responder": [
            ""
          ],
          "entityType": [
            "",
            "case",
            "case_artifact",
            "case_task",
            "case_task_log"
          ]
        }
      }
    },
    {
      "name": "parameters",
      "displayName": "Parameters",
      "type": "fixedCollection",
      "default": {},
      "options": [
        {
          "displayName": "Observable Attributes",
          "name": "values",
          "values": [
            {
              "displayName": "Input Binary Field",
              "name": "binaryPropertyName",
              "type": "string",
              "default": "data",
              "displayOptions": {
                "show": {
                  "dataType": [
                    "file"
                  ]
                }
              },
              "hint": "The name of the input binary field containing the attachement data"
            },
            {
              "displayName": "Data",
              "name": "data",
              "type": "string",
              "default": "",
              "displayOptions": {
                "hide": {
                  "dataType": [
                    "file"
                  ]
                }
              }
            },
            {
              "displayName": "DataType",
              "name": "dataType",
              "type": "options",
              "default": "",
              "options": [
                {
                  "name": "Domain",
                  "value": "domain"
                },
                {
                  "name": "File",
                  "value": "file"
                },
                {
                  "name": "Filename",
                  "value": "filename"
                },
                {
                  "name": "Fqdn",
                  "value": "fqdn"
                },
                {
                  "name": "Hash",
                  "value": "hash"
                },
                {
                  "name": "IP",
                  "value": "ip"
                },
                {
                  "name": "Mail",
                  "value": "mail"
                },
                {
                  "name": "Mail Subject",
                  "value": "mail_subject"
                },
                {
                  "name": "Other",
                  "value": "other"
                },
                {
                  "name": "Regexp",
                  "value": "regexp"
                },
                {
                  "name": "Registry",
                  "value": "registry"
                },
                {
                  "name": "Uri Path",
                  "value": "uri_path"
                },
                {
                  "name": "URL",
                  "value": "url"
                },
                {
                  "name": "User Agent",
                  "value": "user-agent"
                }
              ]
            },
            {
              "displayName": "IOC",
              "name": "ioc",
              "type": "boolean",
              "default": false,
              "description": "Whether the observable is an IOC (Indicator of compromise)"
            },
            {
              "displayName": "Message",
              "name": "message",
              "type": "string",
              "default": ""
            },
            {
              "displayName": "Start Date",
              "name": "startDate",
              "type": "dateTime",
              "default": "",
              "description": "Date and time of the begin of the case default=now"
            },
            {
              "displayName": "Status",
              "name": "status",
              "type": "options",
              "default": "",
              "options": [
                {
                  "name": "Ok",
                  "value": "Ok"
                },
                {
                  "name": "Deleted",
                  "value": "Deleted"
                }
              ],
              "description": "Status of the observable (Ok or Deleted) default=Ok"
            },
            {
              "displayName": "TLP",
              "name": "tlp",
              "type": "options",
              "default": 2,
              "options": [
                {
                  "name": "White",
                  "value": 0
                },
                {
                  "name": "Green",
                  "value": 1
                },
                {
                  "name": "Amber",
                  "value": 2
                },
                {
                  "name": "Red",
                  "value": 3
                }
              ],
              "description": "Traffic Light Protocol (TLP). Default=Amber."
            }
          ]
        }
      ],
      "typeOptions": {
        "loadOptionsDependsOn": [
          "entityType"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            false
          ],
          "entityType": [
            "case_artifact"
          ]
        },
        "hide": {
          "responder": [
            ""
          ],
          "entityType": [
            "",
            "case",
            "alert",
            "case_task",
            "case_task_log"
          ]
        }
      }
    },
    {
      "name": "parameters",
      "displayName": "Parameters",
      "type": "fixedCollection",
      "default": {},
      "options": [
        {
          "displayName": "Task Attributes",
          "name": "values",
          "values": [
            {
              "displayName": "Title",
              "name": "title",
              "type": "string",
              "default": "",
              "description": "Title of the task"
            },
            {
              "displayName": "Status",
              "name": "status",
              "type": "options",
              "default": "Waiting",
              "options": [
                {
                  "name": "Waiting",
                  "value": "Waiting"
                },
                {
                  "name": "InProgress",
                  "value": "InProgress"
                },
                {
                  "name": "Completed",
                  "value": "Completed"
                },
                {
                  "name": "Cancel",
                  "value": "Cancel"
                }
              ]
            },
            {
              "displayName": "Flag",
              "name": "flag",
              "type": "boolean",
              "default": false
            }
          ]
        }
      ],
      "typeOptions": {
        "loadOptionsDependsOn": [
          "entityType"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            false
          ],
          "entityType": [
            "case_task"
          ]
        },
        "hide": {
          "responder": [
            ""
          ],
          "entityType": [
            "",
            "case",
            "alert",
            "case_artifact",
            "case_task_log"
          ]
        }
      }
    },
    {
      "name": "parameters",
      "displayName": "Parameters",
      "type": "fixedCollection",
      "default": {},
      "options": [
        {
          "displayName": "Log Attributes",
          "name": "values",
          "values": [
            {
              "displayName": "Message",
              "name": "message",
              "type": "string",
              "default": ""
            },
            {
              "displayName": "Start Date",
              "name": "startDate",
              "type": "dateTime",
              "default": "",
              "description": "Date and time of the begin of the case default=now"
            },
            {
              "displayName": "Status",
              "name": "status",
              "type": "options",
              "required": true,
              "default": "",
              "options": [
                {
                  "name": "Ok",
                  "value": "Ok"
                },
                {
                  "name": "Deleted",
                  "value": "Deleted"
                }
              ]
            }
          ]
        }
      ],
      "typeOptions": {
        "loadOptionsDependsOn": [
          "entityType"
        ]
      },
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            false
          ],
          "entityType": [
            "case_task_log"
          ]
        },
        "hide": {
          "responder": [
            ""
          ],
          "entityType": [
            "",
            "case",
            "alert",
            "case_artifact",
            "case_task"
          ]
        }
      }
    },
    {
      "name": "operation",
      "displayName": "Operation",
      "type": "options",
      "default": "get",
      "required": true,
      "description": "Choose an operation",
      "options": [
        {
          "name": "Get",
          "value": "get",
          "description": "Get job details",
          "action": "Get a job"
        },
        {
          "name": "Report",
          "value": "report",
          "description": "Get job report",
          "action": "Get a job report"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "job"
          ]
        }
      }
    },
    {
      "name": "jobId",
      "displayName": "Job ID",
      "type": "string",
      "default": "",
      "required": true,
      "description": "ID of the job",
      "displayOptions": {
        "show": {
          "resource": [
            "job"
          ],
          "operation": [
            "get",
            "report"
          ]
        }
      }
    }
  ],
  "credentials": [
    {
      "name": "cortexApi",
      "required": true
    }
  ],
  "hasVersions": false
}