{
  "name": "kafkaTrigger",
  "displayName": "Kafka Trigger",
  "description": "Consume messages from a Kafka topic",
  "group": [
    "trigger"
  ],
  "version": [
    1,
    1.1,
    1.2,
    1.3
  ],
  "defaults": {
    "topic": "",
    "groupId": "",
    "resolveOffset": "onCompletion",
    "allowedStatuses": [
      "success"
    ],
    "useSchemaRegistry": false,
    "schemaRegistryUrl": "",
    "options": {}
  },
  "inputs": [],
  "outputs": [
    "main"
  ],
  "properties": [
    {
      "name": "topic",
      "displayName": "Topic",
      "type": "string",
      "default": "",
      "required": true,
      "description": "Name of the queue of topic to consume from"
    },
    {
      "name": "groupId",
      "displayName": "Group ID",
      "type": "string",
      "default": "",
      "required": true,
      "description": "ID of the consumer group"
    },
    {
      "name": "resolveOffset",
      "displayName": "Resolve Offset",
      "type": "options",
      "default": "onCompletion",
      "description": "Select on which condition the offsets should be resolved. In the manual mode, when execution started by clicking on Execute Workflow or Execute Step button, offsets are always resolved immediately after message received.",
      "options": [
        {
          "name": "On Execution Completion",
          "value": "onCompletion",
          "description": "Resolve offset after execution completion regardless of the status"
        },
        {
          "name": "On Execution Success",
          "value": "onSuccess",
          "description": "Resolve offset only if execution status equals success"
        },
        {
          "name": "On Allowed Execution Statuses",
          "value": "onStatus",
          "description": "Resolve offset only if execution status in the list of selected statuses"
        },
        {
          "name": "Immediately",
          "value": "immediately",
          "description": "Resolve offset immediately after message received. This option is not recommended as it can cause messages loss."
        }
      ],
      "displayOptions": {
        "show": {
          "@version": [
            {
              "_cnd": {
                "gte": 1.3
              }
            }
          ]
        }
      }
    },
    {
      "name": "allowedStatuses",
      "displayName": "Allowed Statuses",
      "type": "multiOptions",
      "default": [
        "success"
      ],
      "options": [
        {
          "name": "Canceled",
          "value": "canceled"
        },
        {
          "name": "Crashed",
          "value": "crashed"
        },
        {
          "name": "Error",
          "value": "error"
        },
        {
          "name": "New",
          "value": "new"
        },
        {
          "name": "Running",
          "value": "running"
        },
        {
          "name": "Success",
          "value": "success"
        },
        {
          "name": "Unknown",
          "value": "unknown"
        },
        {
          "name": "Waiting",
          "value": "waiting"
        }
      ],
      "displayOptions": {
        "show": {
          "@version": [
            {
              "_cnd": {
                "gte": 1.3
              }
            }
          ],
          "resolveOffset": [
            "onStatus"
          ]
        }
      }
    },
    {
      "name": "useSchemaRegistry",
      "displayName": "Use Schema Registry",
      "type": "boolean",
      "default": false,
      "description": "Whether to use Confluent Schema Registry"
    },
    {
      "name": "schemaRegistryUrl",
      "displayName": "Schema Registry URL",
      "type": "string",
      "default": "",
      "required": true,
      "description": "URL of the schema registry",
      "displayOptions": {
        "show": {
          "useSchemaRegistry": [
            true
          ]
        }
      }
    },
    {
      "name": "options",
      "displayName": "Options",
      "type": "collection",
      "default": {},
      "options": [
        {
          "displayName": "Allow Topic Creation",
          "name": "allowAutoTopicCreation",
          "type": "boolean",
          "default": false,
          "description": "Whether to allow sending message to a previously non-existing topic"
        },
        {
          "displayName": "Auto Commit Threshold",
          "name": "autoCommitThreshold",
          "type": "number",
          "default": 0,
          "description": "The consumer will commit offsets after resolving a given number of messages"
        },
        {
          "displayName": "Auto Commit Interval",
          "name": "autoCommitInterval",
          "type": "number",
          "default": 0,
          "description": "The consumer will commit offsets after a given period, for example, five seconds",
          "hint": "Value in milliseconds"
        },
        {
          "displayName": "Batch Size",
          "name": "batchSize",
          "type": "number",
          "default": 1,
          "description": "Number of messages to process in each batch, when set to 1, message-by-message processing is enabled"
        },
        {
          "displayName": "Each Batch Auto Resolve",
          "name": "eachBatchAutoResolve",
          "type": "boolean",
          "default": false,
          "description": "Whether to auto resolve offsets for each batch",
          "displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.3
                  }
                }
              ]
            }
          }
        },
        {
          "displayName": "Fetch Max Bytes",
          "name": "fetchMaxBytes",
          "type": "number",
          "default": 1048576,
          "description": "Maximum amount of data the server should return for a fetch request. In bytes. Default is 1MB. Higher values allow fetching more messages at once."
        },
        {
          "displayName": "Fetch Min Bytes",
          "name": "fetchMinBytes",
          "type": "number",
          "default": 1,
          "description": "Minimum amount of data the server should return for a fetch request. In bytes. Server will wait up to fetchMaxWaitTime for this amount to accumulate."
        },
        {
          "displayName": "Heartbeat Interval",
          "name": "heartbeatInterval",
          "type": "number",
          "default": 10000,
          "description": "Controls how often the consumer sends heartbeats to the broker to indicate it is still alive. Must be lower than Session Timeout. Recommended value is approximately one third of the Session Timeout (for example: 10s heartbeat with 30s session timeout).",
          "hint": "Value in milliseconds",
          "displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.3
                  }
                }
              ]
            }
          }
        },
        {
          "displayName": "Heartbeat Interval",
          "name": "heartbeatInterval",
          "type": "number",
          "default": 3000,
          "description": "Heartbeats are used to ensure that the consumer's session stays active",
          "hint": "The value must be set lower than Session Timeout",
          "displayOptions": {
            "hide": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.3
                  }
                }
              ]
            }
          }
        },
        {
          "displayName": "Max Number of Requests",
          "name": "maxInFlightRequests",
          "type": "number",
          "default": 1,
          "description": "The maximum number of unacknowledged requests the client will send on a single connection"
        },
        {
          "displayName": "Read Messages From Beginning",
          "name": "fromBeginning",
          "type": "boolean",
          "default": true,
          "description": "Whether to read message from beginning"
        },
        {
          "displayName": "JSON Parse Message",
          "name": "jsonParseMessage",
          "type": "boolean",
          "default": false,
          "description": "Whether to try to parse the message to an object"
        },
        {
          "displayName": "Keep Message as Binary Data",
          "name": "keepBinaryData",
          "type": "boolean",
          "default": false,
          "displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.2
                  }
                }
              ]
            }
          },
          "description": "Whether to keep message value as binary data for downstream processing (e.g., Avro deserialization)"
        },
        {
          "displayName": "Parallel Processing",
          "name": "parallelProcessing",
          "type": "boolean",
          "default": true,
          "description": "Whether to process messages in parallel resolving offsets independently or in order resolving offsets after execution completion. In the manual mode, when execution started by clicking on Execute Workflow or Execute Step button, messages are processed in parallel resolving offsets immediately.",
          "displayOptions": {
            "show": {
              "@version": [
                1.1,
                1.2
              ]
            }
          }
        },
        {
          "displayName": "Partitions Consumed Concurrently",
          "name": "partitionsConsumedConcurrently",
          "type": "number",
          "default": 0,
          "description": "Number of Kafka partitions to process in parallel. Controls how many partitions are processed concurrently by the consumer.",
          "hint": "Set to 0 to process all partitions sequentially"
        },
        {
          "displayName": "Only Message",
          "name": "onlyMessage",
          "type": "boolean",
          "displayOptions": {
            "show": {
              "jsonParseMessage": [
                true
              ]
            }
          },
          "default": false,
          "description": "Whether to return only the message property"
        },
        {
          "displayName": "Return Headers",
          "name": "returnHeaders",
          "type": "boolean",
          "default": false,
          "description": "Whether to return the headers received from Kafka"
        },
        {
          "displayName": "Rebalance Timeout",
          "name": "rebalanceTimeout",
          "type": "number",
          "default": 600000,
          "description": "The maximum time allowed for a consumer to join the group"
        },
        {
          "displayName": "Retry Delay on Error",
          "name": "errorRetryDelay",
          "type": "number",
          "default": 5000,
          "description": "Delay in milliseconds before retrying after a failed offset resolution. This prevents rapid retry loops that could overwhelm the Kafka broker.",
          "hint": "Value in milliseconds",
          "typeOptions": {
            "minValue": 1000
          },
          "displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.3
                  }
                }
              ]
            },
            "hide": {
              "/resolveOffset": [
                "immediately"
              ]
            }
          }
        },
        {
          "displayName": "Session Timeout",
          "name": "sessionTimeout",
          "type": "number",
          "default": 30000,
          "description": "Timeout in milliseconds used to detect failures. Has to be higher than Heartbeat Interval. During the workflow execution heartbeat will be sent periodically to keep the session alive with configured Heartbeat Interval.",
          "hint": "Value in milliseconds"
        }
      ]
    }
  ],
  "credentials": [
    {
      "name": "kafka",
      "required": true
    }
  ],
  "hasVersions": false
}